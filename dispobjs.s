%%HP: T(0)A(R)F(.);
"%This file is licensed
%under GPL v2

%DISPOBJS.S
%AFFICHONS LE TABLEAU
%DES OBJETS

%WARNING:REMOVE NEXT 4
%&END BEFORE OPERATING
%GOSBVL 0679B
%C=DAT1 A
%D1=C
%D1=D1+ 10

%dXXYYeMGMD48OBJS
%ENTREE:D1çETAT JOUEUR
D1=D1+ 6
D1=D1+ 15
%D1+2çOBJS PORTES
CD1EX
R0=C A
%LC2SPRSAC
LC 20
GOSUBL GOLEVCb
C=C-1 A
R1=C A

%Bs=LIGNES RESTANTES
%As=OBJS RESTANTS SURL
LC 2 %3 LIGNES
CSRC
B=C S
GOSBVL 01C31
LC 00021
A=A+C A
%A=DESTINATION
GOSUB DISPOBJS.COMMENCONS
D1=A
D1=D1+ 1
LC 05
GOSUBL BLANKLINES
GOSUB DISPPOCHES
GOTO FINDECESOURCE
*DISPOBJS.COMMENCONS
ST=0 2 %PAS MAIN POUR NOBJçNSPR
*UNE.LIGNE.DE.+
ASLC
LA 5
ASRC
*UN.OBJ.DE.+
C=R0 A
C=C+2 A
R0=C A
D1=C
C=0 A
C=DAT1 B
%C=NUMERO D'OBJ
B=A A %CAR MODIFI… PAR
GOSUB NOBJçNSPR
A=B A
C=C+C X
%MULTONS PAR 23=16+8-1
B=C A
B=B+B X
B=B+C X
B=B+B X
B=B+B A
B=B+B A
B=B-C A
C=R1 A
C=C+B A
D1=C %D1=GROBJ
C=A S
CSLC
ST=0 0
?CBIT=0 0
GOYES NOSPECIAL
ST=1 0
A=A+1 A
*NOSPECIAL
GOSUB DISP1OBJ
%A EST INCREMENTE
A=A-1 S
GONC UN.OBJ.DE.+
%D0=FIN BAS
D0=D0- 9
D0=D0- 9
AD0EX
B=B-1 S
GONC UNE.LIGNE.DE.+
RTN

*DISPPOCHES
%LC5PPOCHE-2
LC 0004A
GOSUBL GONLEV1Ca
R0=C A
%LC2SPRSAC
LC 20
GOSUBL GOLEVCb
C=C-1 A
R1=C A

%Bs=LIGNES RESTANTES
%As=OBJS RESTANTS SURL
LC 0
CSRC
B=C S
GOSBVL 01C31
LC 00681
A=A+C A
%A=DESTINATION
D0=A
P= 11
C=0 WP
C=-C-1 WP
DAT0=C WP
D0=D0+ 10
DAT0=C WP
P= 0
D0=D0+ 12
D0=D0+ 12
AD0EX
GOSUB DISPOBJS.COMMENCONS
RTN

'DISP1OBJ.S
%'GOROUTINES.S
%'NPUTFOND.S
*FINDECESOURCE
%GOVLNG 05143
@"