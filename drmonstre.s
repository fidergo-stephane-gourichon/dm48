%%HP: T(0)A(R)F(.);
"%This file is licensed
%under GPL v2

%DRMONSTRE.S

*DRMONSTRE
?ST=0 2 %OBV/MONST/NUAGE
RTNYES

*OKMONSTRE
%LC2MONSTR
LC 06
GOSUBL GOLEVCb

A=R3 A
B=A A %CASE
P= 15 %TAILLE DU BLOC DANS FLUXMONSTRE
GOSUB SEEKB4ATFLUC
%D0=DATASCASE
GONC OK.MONSTREHERE
%LC EE
%GOLONG ERRORCb
GOTO PAS.DE.MONSTRE
%MAIS OBJ VOLANT
%PROBABLEMENT!

*OK.MONSTREHERE
%LC2MONSTL
LC 1E
GOSUBL GOLEVCb
%D1=Ca=LLMONSTRESPR

A=DAT0 A %TYPE/AGE
B=A B
C=R3 S %DJ
CSLC %DEBORD EXPRES
B=B-C B
LC FC
A=A&C B
C=-C-1 B
B=B&C B
A=A!B B %N∞DIR MONSTRE

C=0 A
C=A B
GOSUBL D1çLLCaGET
D0=C %D0:SPR

%ON TIENT LE SPRITE
%MAINTENANT
%DETERMINONS Y
C=R4 S %õY
C=C-1 S
GOC VERS.MONS.OUTOFSCREEN
%OUF.MONSTRE.PAS.SUR.MOI
B=C S
C=C+C S
C=C+C S
C=C+B S

P=C 15
%LC 005B6004840041E0
LC 0059400462003FC0
%{ # B6Ch # 5B6h # 484h # 41Eh }
%{ # B4Ah # 594h # 462h # 3FCh }
%´ { 2 6 10 14 } 64 -2 * SWAP / 21 SWAP - IP 1 ADD 34 * RçB ª
P= 0

GOSUB FINTALBXGMONS
%$A20000A20000A244010000A2C381F450
$6300006316B06305C19630638442B511
*FINTALBXGMONS
A=0 A
A=R0 S
ASLC
A=A+A A %2Q PAR CASE
C=RSTK
C=C+A A
D1=C %ADR OU LIRE Xg
A=0 A
A=DAT1 B
A=A-1 B
GONC MONS.PAS.OUTOFSCREEN
*VERS.MONS.OUTOFSCREEN
GOTO MONS.OUTOFSCREEN
*MONS.PAS.OUTOFSCREEN
LC 03
C=C&A B
ASRB B
ASRB B
CSLC
CSLC
B=C XS
CSLC
CSLC
CSLC

C=C+A A
D=C A
%LC2GRTEMP
LC 01
GOSUBL GOLEVCb
C=C+D A
C=C+7 A %10(GROB)-3(12PIX)
D1=C    %DEST

A=R4 S
A=A+A S
A=A+A S
A=A+2 S %DENOM
ST=0 4

%IF FAUT SAUVER
%R3a&s DANS R0m %%%%
C=R3 %A SAUVER
CSRC
CSRC
CSRC
CSRC
CSRC
CSRC
R0=C M

C=R1 S %CRY
C=C+1 S
R1=C S
GOSUB BBCD01SZREPL
%RECUP R3
C=R0 M
CSLC
CSLC
CSLC
CSLC
CSLC
CSLC
R3=C

ST=1 10 %DISP-PERIODIQUE

%*NOMONSTRE(0)
*PAS.DE.MONSTRE
*MONS.OUTOFSCREEN
RTN

'SZREPL.S
%PIPOINCLUDE
%'LLGET.S
%'ERREUR.S
%'GOROUTINES.S
%'SEE .S
@"