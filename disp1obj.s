%%HP: T(0)A(R)F(.);
"%This file is licensed
%under GPL v2

%DISP1OBJ.S
%AFFICHE 1 OBJ 13*13
%ENTREE:
%D1çQUARTETS (3.5*14)
%AçZONE OŸ ECRIRE
%ST 0=1/0
%P= 0
%MOD:D0D1AaBxCwDa
%GOSBVL 0679B
%C=DAT1 A
%D1=C
%D1=D1+ 10
%GOSBVL 01C31


*DISP1OBJ
LC 603
B=C X
LC 4000
D=C A
%D1=D1- 1
D0=A
ASLC
ASLC
ASLC
*DISP1LIGNE
P= 7
C=DAT1 WP
D1=D1+ 7
CSRB WP
CSRB WP
P= 3
CSRB WP
CSRB WP
C=C!D WP
GOSUB WRITEIT
CSRC
CSRC
CSRC
CSRC
?Bã0 XS
GOYES NORMAL
C=0 WP
C=-C-1 WP
CSRB WP
*NORMAL
C=C!D WP
GOSUB WRITEIT
B=B-1 XS
GONC DISP1LIGNE
P= 0
ASRC
ASRC
ASRC
A=A+3 A
%GOVLNG 05143
RTN
*WRITEIT
?ST=1 0
GOYES DIRECTWRITE
C=C+C WP
C=C+C WP
A=DAT0 B
A=A&B B
C=C!A B
*DIRECTWRITE
DAT0=C WP
D0=D0+ 12
D0=D0+ 11
D0=D0+ 11
RTN
*DISP1OBJN
%AFFICHE UN SPR PAR
%SON NUMERO EN ALLANT
%CHERCHER TOUT SEUL
%LES DONNEES SUR LE
%NIVEAU 7.

%CbçNUMERO
%AaçOFFSET POUR ECRIRE
%ST 0=1/0
%P= 0
B=A A
D=C B
%LC2GRDEST
LC 02
GOSUBL GOLEVCb
C=C+B A
D0=C %D0=ADRDEST

C=0 A
C=D B
A=C A
CSL A
B=C A
C=C+C A
B=B+C A
A=A+A A
B=B-A A %B=46*
%LC5SPRSAC
LC 20
GOSUBL GOLEVCb
C=C+B A
D1=C %D1=QUARTETS
D1=D1- 1
AD0EX %A=DEST

GOTO DISP1OBJ

*DISPMAINDROITE
%LC2MDROITE
LC 00026
GOSUBL GONLEV1Ca
C=DAT1 B
ST=1 2
GOSUB NOBJçNSPR
?Cã0 B
GOYES MDPASVIDE
LC 01
*MDPASVIDE
LA 00445 %43Bh+10d
ST=1 0
GOTO DISP1OBJN
*DISPMAINGAUCHE
%LC5MGAUCHE
LC 00024
GOSUBL GONLEV1Ca
C=DAT1 B
ST=1 2
GOSUB NOBJçNSPR
?Cã0 B
GOYES MGPASVIDE
LC 02
*MGPASVIDE
LA 00441
ST=0 0
GOTO DISP1OBJN

*NOBJçNSPR
%PREND Cb=N∞OBJ
%RESSORT Cb=N∞SPRITE
%ST 2 = 1 SI MAIN
%0 SI PAS MAIN.
%MAIS ERREUR SI
%OBJET INTERDIT
%MODIFIE Aa Ca D1
?C=0 B
GOYES CbNSPROKBIS
A=C B
LC 03
?AãC B
GOYES NONMAINVIDE
GOTO AbNSPROK
*NONMAINVIDE
LC 08
?AäC B %OBJ<8?
GOYES AUTORISE
LC 2C
GOLONG ERRORCb
*AUTORISE
LC 18
?AãC B
GOYES NOBOUSSOLE
GOSUBL GOHOME
C=0 A
C=DAT1 1
C=C+C B
LA 18
C=C+A A
*CbNSPROKBIS
GOTO CbNSPROK
*NOBOUSSOLE
C=C+1 B
?AâC B
GOYES NOTORCHE
LC 1F
?AâC B
GOYES TORCHE
*NOTORCHE
LC 37
?AâC B
GOYES NOPARCH
LA 37
*NOPARCH
*AbNSPROK
C=A B
*CbNSPROK
RTN
*TORCHE
LC 19
?ST=0 2
GOYES CbNSPROK
LC 1A
A=A-C B %A=0‡5
LC 00104
D1=C
C=0 X
C=DAT1 1
CSRB P
CSRB P
C=C-1 B
GONC TORPAS0
LC 02
*TORPAS0
%C=00,01,01,02
C=C+A P %C=0¿7
CSRB P %C=0¿3
C=C+C P
LA 19
C=C+A B
GOTO CbNSPROK
@"